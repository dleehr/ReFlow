{% extends "base.html" %}
{% load url from future %}

{% block extra_head %}
<link rel="stylesheet" href="{{ STATIC_URL }}jquery-ui-1.9.2.custom/css/overcast/jquery-ui-1.9.2.custom.css" />
{% endblock %}

{% block toes %}
<script src="{{ STATIC_URL }}jquery-ui-1.9.2.custom/js/jquery-ui-1.9.2.custom.js"></script>

<script>
$(document).ready(function()
{
    var add_param_dialog = $("<div></div>").dialog(
    {
        autoOpen: false,
        title: 'Add a Parameter',
        modal: true,
        position: 'center',
        height: 300,
        width: 500
    });

    $(".add_parameter").click(function()
    {
        add_param_dialog.dialog({ close: function() { $(this).empty(); } });
        add_param_dialog.load($(this).data("form"));
        add_param_dialog.dialog('open');
    });
    return false;
});

</script>
{% endblock %}

{% block body %}
  <div class="container">
    <div class="row lead">
      <div class="span4">
        <a href="{% url 'repository.views.view_project' project.id %}">{{ project.project_name }}</a>
      </div>
      <div class="pull-right">Panels <span class="badge badge-inverse align-top">{{ panels.count }}</span></div>
    </div>
    <table class="table table-bordered table-striped">
      <thead>
        <tr>
          <th>Panel</th>
          <th>Site</th>
          <th>Parameters</th>
        </tr>
      </thead>
      <tbody>
        {% for panel in panels %}
        <tr>
          <td>
            {{ panel.panel_name }}
            <span class="pull-right">
              <a rel="tooltip" href="{% url 'edit_panel' panel.id %}" data-original-title="Edit Panel" data-placement="left">
                  <i style="opacity: 0.4" class="icon-th-list align-middle"></i>
              </a>
            </span>
          </td>
          <td>{{ panel.site.site_name }}</td>
          <td>
            <span class="pull-right">
              <a class="add_parameter" rel="tooltip" href="#" data-form="{% url 'add_panel_parameter' panel.id %}" data-original-title="Add Parameter" data-placement="left">
                <i style="opacity: 0.4" class="icon-plus align-middle"></i>
              </a>
            </span>
            {% for ppm in panel.panelparametermap_set.all %}
            {{ ppm.parameter.parameter_short_name }}-{{ ppm.value_type.value_type_short_name }}
            {% if not forloop.last %}<br/>{% endif %}
            {% endfor %}
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    <div class="pull-right">
      <a class="btn btn-success btn-small" href="{% url 'add_panel' project.id %}">
        <i class="icon-plus icon-white"></i> Add Panel
      </a>
    </div>
  </div>
{% endblock %}