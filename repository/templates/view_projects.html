{% extends "base.html" %}
{% load url from future %}
{% load repository_filters %}
{% block body %}
  <div class="container">
    <div class="row lead">
      <div class="span4">
        Home
      </div>
      <div class="pull-right">Projects <span class="badge badge-inverse align-top">{{ projects|length }}</span></div>
    </div>
    {{ projects.count }}

    {% if projects %}
    <table class="table table-bordered table-striped">
      <thead>
        <tr>
          <th>Project Name</th>
          <th>Permissions</th>
        </tr>
      </thead>

      <tbody>

      {% for p in projects %}
        <tr>
          <td>
            <a href="{% url 'repository.views.view_project' p.id %}">{{ p.project_name }}</a>
          </td>
          <td>
          {%  for user_perm in p|get_user_permissions:user %}
            {{ user_perm.permission.name }}<br/>
          {% endfor %}
          </td>
        </tr>
      {% endfor %}

      </tbody>
    </table>

    {% else %}
    <p>You do not belong to any projects. <a href="{% url 'repository.views.add_project'%}">Create a new project</a></p>
    {% endif %}
  </div>
{% endblock %}