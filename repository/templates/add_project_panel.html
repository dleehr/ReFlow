{% extends "base.html" %}
{% load url from future %}
{% load breadcrumbs %}

{% block breadcrumbs %}
  <ul class="breadcrumb">
    {% breadcrumb_url 'Home' 'home' %}
    {% breadcrumb_url project.project_name 'view_project' project.id %}
    {% breadcrumb_url 'Project Panels' 'view_project_panels' project.id %}
    {% breadcrumb "Add Project Panel" %}
  </ul>
{% endblock %}

{% block body %}
  <div class="container">
    <form class="form-horizontal" action="{% url 'add_project_panel' project.id %}" method="post">
      {% csrf_token %}
        {% if panel_form.non_field_errors %}
          <div class="control-group text-error">
            {{ panel_form.non_field_errors }}
            {{ parameter_formset.non_form_errors }}
          </div>
        {% endif %}

        {% for field in panel_form %}
          <div class="control-group">
            <label class="control-label">{{ field.label }}</label>
            <div class="controls">
              {{ field }}
              {% if field.errors %}
                <span class="align-middle text-warning">&nbsp;{{ field.errors|striptags }}</span>
              {% endif %}
            </div>
          </div>
        {% endfor %}
          {{ parameter_formset.management_form }}
        <table class="table">
          <thead>
            <tr>
              <th>Type</th>
              <th>Value Type</th>
              <th>Fluorochrome</th>
              <th>Delete</th>
            </tr>
          </thead>
          <tbody></tbody>
          {% for parameter_form in parameter_formset %}
          <tr>
          {% for field in parameter_form.visible_fields %}
            <td>
            {{ field }}
            {{ field.errors }}
            </td>
          {% endfor %}
          {% if parameter_form.nested %}
            <td>
              {% for antibody_formset in parameter_form.nested %}
                {{ antibody_formset.as_table }}
            {% endfor %}
            </td>
          {% endif %}
          </tr>
          {% endfor %}
        </table>
      <div class="control-group">
        <div class="controls">
          <button class="btn btn-small btn-success" type="submit">Save</button>
        </div>
      </div>
    </form>
  </div>
{% endblock %}